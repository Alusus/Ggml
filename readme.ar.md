<div dir=rtl>

# جـجمل - روابط مكتبة GGML للغة الأسس
[[English]](readme.md)

روابط لغة الأسس لمكتبة [GGML](https://github.com/ggml-org/ggml) للموترات.


## الاستخدام

```
اشمل "مـحا"؛
مـحا.اشمل_ملف("Alusus/Ggml"، "جـجمل.أسس")؛
استخدم جـجمل؛
```

<div dir=ltr>

```
import "Apm";
Apm.importFile("Alusus/Ggml");
use Ggml;
```

</div>

## الأمثلة

راجع مجلد `Examples/`:
- `مثال.أسس` - ضرب مصفوفات باستخدام السياق
- `مثال_المشغل.أسس` - ضرب مصفوفات باستخدام المشغل (فلكان/المعالج)


## دعم فلكان

لتفعيل مشغل فلكان، حدد متغير البيئة قبل التشغيل:

<div dir=ltr>

```bash
export GGML_USE_VULKAN=1
```

</div>


## مرجع الواجهة البرمجية

### الدوال العامة

| الدالة                    | الصنف                                                     |
|---------------------------|-----------------------------------------------------------|
| `هيئ`                     | `(معطيات: مـعطيات_تهيئة): سند[سـياق]`                     |
| `حرر`                     | `(سياق: سند[سـياق])`                                      |
| `هات_تكلفة_الموتر`        | `(): طـبيعي_متكيف`                                        |
| `هات_حجم_النوع`           | `(نوع: صحيح): طـبيعي_متكيف`                               |
| `هات_حجم_الصف`            | `(نوع: صحيح، ب_ع: صحيح[64]): طـبيعي_متكيف`                |
| `هات_تكلفة_البيان`        | `(): طـبيعي_متكيف`                                        |
| `حدد_دالة_الإجهاض`         | `(د: مؤشر[دالة(مؤشر_محارف)]): مؤشر[دالة(مؤشر_محارف)]`     |
| `أجهض`                    | `(ملف: مؤشر_محارف، سطر: صحيح، صيغة: مؤشر_محارف، ...أيما)` |
| `حول_نوع_بنية_إلى_نوع`    | `(نوع_بنية: صحيح): صحيح`                                  |
| `حول_الحالة_لنص`          | `(حالة: صحيح): مؤشر_محارف`                                |
| `حول_ع16_إلى_ع32`         | `(ق: طـبيعي[16]): عائم`                                   |
| `حول_ع16_إلى_ع32`         | `(من: سند[مصفوفة[طـبيعي[16]]]،`                           |
|                           | ` إلى سند[مصفوفة[عـائم]]، الطول: صـحيح[64])`              |
| `حول_ع32_إلى_ع16`         | `(ق: عائم): طـبيعي[16]`                                   |
| `حول_ع32_إلى_ع16`         | `(من: سند[مصفوفة[عـائم]]،`                                |
|                           | ` إلى سند[مصفوفة[طـبيعي[16]]]، الطول: صـحيح[64])`         |
| `حول_ع32_إلى_عد16`        | `(ق: عائم): طـبيعي[16]`                                   |
| `حول_ع32_إلى_عد16`        | `(من: سند[مصفوفة[عـائم]]،`                                |
|                           | ` إلى سند[مصفوفة[طـبيعي[16]]]، الطول: صـحيح[64])`         |
| `حول_عد16_إلى_ع32`        | `(ق: طـبيعي[16]): عائم`                                   |
| `حول_عد16_إلى_ع32`        | `(من: سند[مصفوفة[طـبيعي[16]]]،`                           |
|                           | ` إلى سند[مصفوفة[عـائم]]، الطول: صـحيح[64])`              |
| `ابن_توسيعا_أماميا`       | `(بيان: سند[بـيان]، موتر: سند[مـوتر])`                    |
| `ابن_توسيعا_خلفيا`        | `(سياق: سند[سـياق]، بيان: سند[بـيان]،`                    |
|                           | ` موتر: سند[سند[مـوتر]])`                                 |

<div dir=ltr>

| Function             | Signature                                             |
|----------------------|-------------------------------------------------------|
| `init`               | `(params: InitParams): ref[Context]`                  |
| `free`               | `(ctx: ref[Context])`                                 |
| `getTensorOverhead`  | `(): ArchWord`                                        |
| `getTypeSize`        | `(type: Int): ArchWord`                               |
| `getRowSize`         | `(type: Int, ne: Int[64]): ArchWord`                  |
| `getGraphOverhead`   | `(): ArchWord`                                        |
| `setAbortCallback`   | `(cb: ptr[func(CharsPtr)]): ptr[func(CharsPtr)]`      |
| `abort`              | `(file: CharsPtr, line: Int, fmt: CharsPtr, ...any)`  |
| `fTypeToType`        | `(ftype: Int): Int`                                   |
| `statusToString`     | `(status: Int): CharsPtr`                             |
| `fp16ToFp32`         | `(v: Word[16]): Float`                                |
| `fp16ToFp32`         | `(src: ref[array[Word[16]]],`                         |
|                      | ` dst: ref[array[Float]],`                            |
|                      | ` len: Int[64])`                                      |
| `fp32ToFp16`         | `(v: Float): Word[16]`                                |
| `fp32ToFp16`         | `(src: ref[array[Float]],`                            |
|                      | ` dst: ref[array[Word[16]]],`                         |
|                      | ` len: Int[64])`                                      |
| `fp32ToBf16`         | `(v: Float): Word[16]`                                |
| `fp32ToBf16`         | `(src: ref[array[Float]],`                            |
|                      | ` dst: ref[array[Word[16]]],`                         |
|                      | ` len: Int[64])`                                      |
| `bf16ToFp32`         | `(v: Word[16]): Float`                                |
| `bf16ToFp32`         | `(src: ref[array[Word[16]]],`                         |
|                      | ` dst: ref[array[Float]],`                            |
|                      | ` len: Int[64])`                                      |
| `buildForwardExpand` | `(graph: ref[CGraph], tensor: ref[Tensor])`           |
| `buildBackwardExpand`| `(context: ref[Context],`                             |
|                      | ` graph: ref[CGraph],`                                |
|                      | ` tensor: ref[ref[Tensor]])`                          |

</div>

### سرد `حـالة` (`Status`)

| الثابت        | القيمة | الوصف            |
|---------------|--------|------------------|
| `_فشل_الحجز_` | -2     | فشل حجز الذاكرة  |
| `_فشل_`       | -1     | فشلت العملية     |
| `_نجاح_`      | 0      | نجحت العملية     |
| `_إجهاض_`     | 1      | أُجهضت العملية    |

<div dir=ltr>

| Constant       | Value | Description               |
|----------------|-------|---------------------------|
| `ALLOC_FAILED` | -2    | Memory allocation failed  |
| `FAILED`       | -1    | Operation failed          |
| `SUCCESS`      | 0     | Operation succeeded       |
| `ABORTED`      | 1     | Operation aborted         |

</div>

### سرد `نـوع` (`Type`)

| الثابت    | القيمة | الوصف                |
|-----------|--------|----------------------|
| `_ع32_`   | 0      | عائم 32 بت           |
| `_ع16_`   | 1      | عائم 16 بت           |
| `_ك4_0_`  | 2      | مكمم 4 بت (نسخة 0)   |
| `_ك4_1_`  | 3      | مكمم 4 بت (نسخة 1)   |
| `_ك5_0_`  | 6      | مكمم 5 بت (نسخة 0)   |
| `_ك5_1_`  | 7      | مكمم 5 بت (نسخة 1)   |
| `_ك8_0_`  | 8      | مكمم 8 بت (نسخة 0)   |
| `_ك8_1_`  | 9      | مكمم 8 بت (نسخة 1)   |
| `_ك2_ك_`  | 10     | مكمم 2 بت (ك)        |
| `_ك3_ك_`  | 11     | مكمم 3 بت (ك)        |
| `_ك4_ك_`  | 12     | مكمم 4 بت (ك)        |
| `_ك5_ك_`  | 13     | مكمم 5 بت (ك)        |
| `_ك6_ك_`  | 14     | مكمم 6 بت (ك)        |
| `_ص8_`    | 24     | صحيح 8 بت            |
| `_ص16_`   | 25     | صحيح 16 بت           |
| `_ص32_`   | 26     | صحيح 32 بت           |
| `_ص64_`   | 27     | صحيح 64 بت           |
| `_ع64_`   | 28     | عائم 64 بت           |
| `_عد16_`  | 30     | عائم دماغي 16 بت     |

<div dir=ltr>

| Constant   | Value | Description                    |
|------------|-------|--------------------------------|
| `F32`      | 0     | 32-bit float                   |
| `F16`      | 1     | 16-bit float                   |
| `Q4_0`     | 2     | 4-bit quantized (variant 0)    |
| `Q4_1`     | 3     | 4-bit quantized (variant 1)    |
| `Q5_0`     | 6     | 5-bit quantized (variant 0)    |
| `Q5_1`     | 7     | 5-bit quantized (variant 1)    |
| `Q8_0`     | 8     | 8-bit quantized (variant 0)    |
| `Q8_1`     | 9     | 8-bit quantized (variant 1)    |
| `Q2_K`     | 10    | 2-bit K-quantized              |
| `Q3_K`     | 11    | 3-bit K-quantized              |
| `Q4_K`     | 12    | 4-bit K-quantized              |
| `Q5_K`     | 13    | 5-bit K-quantized              |
| `Q6_K`     | 14    | 6-bit K-quantized              |
| `IQ2_XXS`  | 16    | IQ 2-bit extra extra small     |
| `IQ2_XS`   | 17    | IQ 2-bit extra small           |
| `IQ3_XXS`  | 18    | IQ 3-bit extra extra small     |
| `IQ1_S`    | 19    | IQ 1-bit small                 |
| `IQ4_NL`   | 20    | IQ 4-bit non-linear            |
| `IQ3_S`    | 21    | IQ 3-bit small                 |
| `IQ2_S`    | 22    | IQ 2-bit small                 |
| `IQ4_XS`   | 23    | IQ 4-bit extra small           |
| `I8`       | 24    | 8-bit integer                  |
| `I16`      | 25    | 16-bit integer                 |
| `I32`      | 26    | 32-bit integer                 |
| `I64`      | 27    | 64-bit integer                 |
| `F64`      | 28    | 64-bit float                   |
| `IQ1_M`    | 29    | IQ 1-bit medium                |
| `BF16`     | 30    | Brain float 16-bit             |

</div>

### سرد `نـوع_بنية` (`FType`)

| الثابت                    | القيمة |
|---------------------------|--------|
| `_مجهول_`                 | -1     |
| `_كله_ع32_`               | 0      |
| `_أغلبه_ع16_`             | 1      |
| `_أغلبه_ك4_0_`            | 2      |
| `_أغلبه_ك4_1_`            | 3      |
| `_أغلبه_ك4_1_وبعض_ع16_`   | 4      |
| `_أغلبه_ك8_0_`            | 7      |
| `_أغلبه_ك5_0_`            | 8      |
| `_أغلبه_ك5_1_`            | 9      |
| `_أغلبه_ك2_ك_`            | 10     |
| `_أغلبه_ك3_ك_`            | 11     |
| `_أغلبه_ك4_ك_`            | 12     |
| `_أغلبه_ك5_ك_`            | 13     |
| `_أغلبه_ك6_ك_`            | 14     |
| `_أغلبه_عد16_`            | 24     |

<div dir=ltr>

| Constant                 | Value |
|--------------------------|-------|
| `UNKNOWN`                | -1    |
| `ALL_F32`                | 0     |
| `MOSTLY_F16`             | 1     |
| `MOSTLY_Q4_0`            | 2     |
| `MOSTLY_Q4_1`            | 3     |
| `MOSTLY_Q4_1_SOME_F16`   | 4     |
| `MOSTLY_Q8_0`            | 7     |
| `MOSTLY_Q5_0`            | 8     |
| `MOSTLY_Q5_1`            | 9     |
| `MOSTLY_Q2_K`            | 10    |
| `MOSTLY_Q3_K`            | 11    |
| `MOSTLY_Q4_K`            | 12    |
| `MOSTLY_Q5_K`            | 13    |
| `MOSTLY_Q6_K`            | 14    |
| `MOSTLY_IQ2_XXS`         | 15    |
| `MOSTLY_IQ2_XS`          | 16    |
| `MOSTLY_IQ3_XXS`         | 17    |
| `MOSTLY_IQ1_S`           | 18    |
| `MOSTLY_IQ4_NL`          | 19    |
| `MOSTLY_IQ3_S`           | 20    |
| `MOSTLY_IQ2_S`           | 21    |
| `MOSTLY_IQ4_XS`          | 22    |
| `MOSTLY_IQ1_M`           | 23    |
| `MOSTLY_BF16`            | 24    |
| `MOSTLY_MXFP4`           | 25    |

</div>

### `مـعطيات_تهيئة`(`InitParams`)

| الحقل             | الصنف         |
|-------------------|---------------|
| `حجم_الذاكرة`     | طـبيعي_متكيف  |
| `صوان_الذاكرة`    | مؤشر          |
| `بلا_حجز`          | ثنائي         |

<div dir=ltr>

| Field       | Type     |
|-------------|----------|
| `memSize`   | ArchWord |
| `memBuffer` | ptr      |
| `noAlloc`   | Bool     |

</div>

### `سـياق` (`Context`)

| الدالة                        | الصنف                                                 |
|-------------------------------|-------------------------------------------------------|
| `أنشئ_موترا`                  | `(نوع: صحيح، ب_ع0: صحيح[64]): سند[مـوتر]`             |
| `أنشئ_موترا`                  | `(نوع: صحيح، ب_ع0: صحيح[64]،`                         |
|                               | ` ب_ع1: صحيح[64]): سند[مـوتر]`                        |
| `أنشئ_موترا`                  | `(نوع: صحيح، ب_ع0-2: صحيح[64]): سند[مـوتر]`           |
| `أنشئ_موترا`                  | `(نوع: صحيح، ب_ع0-3: صحيح[64]): سند[مـوتر]`           |
| `كرر`                         | `(أ: سند[مـوتر]): سند[مـوتر]`                         |
| `كرر`                         | `(أ: سند[بـيان]، فرض_تدرجات: ثنائي): سند[بـيان]`      |
| `أنشئ_بيانا`                  | `(): سند[بـيان]`                                      |
| `أنشئ_بيانا`                  | `(حجم: طـبيعي_متكيف، تدرجات: ثنائي): سند[بـيان]`      |
| `احجز_موترات_مشغل`            | `(مشغل: سند[مـشغل]): سند[صـوان_مشغل]`                 |
| `اجمع`                        | `(أ: سند[مـوتر]، ب: سند[مـوتر]): سند[مـوتر]`          |
| `اطرح`                        | `(أ: سند[مـوتر]، ب: سند[مـوتر]): سند[مـوتر]`          |
| `اضرب`                        | `(أ: سند[مـوتر]، ب: سند[مـوتر]): سند[مـوتر]`          |
| `قسم`                         | `(أ: سند[مـوتر]، ب: سند[مـوتر]): سند[مـوتر]`          |
| `لوغاريتم`                    | `(م: سند[مـوتر]): سند[مـوتر]`                         |
| `مجموع`                       | `(أ: سند[مـوتر]): سند[مـوتر]`                         |
| `متوسط`                       | `(أ: سند[مـوتر]): سند[مـوتر]`                         |
| `أقصى_معامل`                  | `(أ: سند[مـوتر]): سند[مـوتر]`                         |
| `معيار`                       | `(أ: سند[مـوتر]): سند[مـوتر]`                         |
| `معيار_المتوسط`               | `(أ: سند[مـوتر]، إبسلون: عائم): سند[مـوتر]`           |
| `اضرب_مصفوفات`                | `(أ: سند[مـوتر]، ب: سند[مـوتر]): سند[مـوتر]`          |
| `حجم`                         | `(أ: سند[مـوتر]، ألفا: عائم): سند[مـوتر]`             |
| `حدد`                         | `(أ: سند[مـوتر]، قيمة: عائم): سند[مـوتر]`             |
| `انسخ_إلى`                    | `(مصدر: سند[مـوتر]، وجهة: سند[مـوتر]): سند[مـوتر]`    |
| `استمر`                       | `(أ: سند[مـوتر]): سند[مـوتر]`                         |
| `أعد_التشكيل`                 | `(أ: سند[مـوتر]، ب: سند[مـوتر]): سند[مـوتر]`          |
| `أعد_التشكيل`                 | `(أ: سند[مـوتر]، ب_ع0: صحيح[64]): سند[مـوتر]`         |
| `أعد_التشكيل`                 | `(أ: سند[مـوتر]، ب_ع0-3: صحيح[64]): سند[مـوتر]`       |
| `اعرض`                        | `(أ: سند[مـوتر]، ب_ع0: صحيح[64]،`                     |
|                               | ` إزاحة: طـبيعي_متكيف): سند[مـوتر]`                   |
| `بدل`                         | `(أ: سند[مـوتر]، محور1-4: صحيح): سند[مـوتر]`          |
| `منقولة`                      | `(أ: سند[مـوتر]): سند[مـوتر]`                         |
| `هات_صفوفا`                   | `(أ: سند[مـوتر]، ب: سند[مـوتر]): سند[مـوتر]`          |
| `حدد_صفوفا`                   | `(أ: سند[مـوتر]، ب: سند[مـوتر]،`                      |
|                               | ` ج: سند[مـوتر]): سند[مـوتر]`                         |
| `قطري`                        | `(أ: سند[مـوتر]): سند[مـوتر]`                         |
| `قناع_قطري_لا_نهائي`           | `(أ: سند[مـوتر]، ن_سابق: صحيح): سند[مـوتر]`           |
| `قناع_قطري_لا_نهائي_موضعيا`    | `(أ: سند[مـوتر]، ن_سابق: صحيح): سند[مـوتر]`           |
| `قناع_قطري_صفري`              | `(أ: سند[مـوتر]، ن_سابق: صحيح): سند[مـوتر]`           |
| `قناع_قطري_صفري_موضعيا`       | `(أ: سند[مـوتر]، ن_سابق: صحيح): سند[مـوتر]`           |
| `أسية_مطبعة`                  | `(أ: سند[مـوتر]): سند[مـوتر]`                         |
| `تضمين_موضعي_دوار`            | `(أ: سند[مـوتر]، ب: سند[مـوتر]،`                      |
|                               | ` ن_أبعاد: صحيح، وضع: صحيح): سند[مـوتر]`              |
| `حشو`                         | `(م: سند[مـوتر]، ح0-3: صحيح): سند[مـوتر]`             |
| `لف`                          | `(م: سند[مـوتر]، إزاحة0-3: صحيح): سند[مـوتر]`         |
| `شغل_البيان`                  | `(بيان: سند[بـيان]، عدد_المسالك: صحيح): صحيح`         |

<div dir=ltr>

| Method                | Signature                                         |
|-----------------------|---------------------------------------------------|
| `newTensor`           | `(type: Int, nDims: Int,                          |
|                       |   ne: ref[array[Int[64]]]): ref[Tensor]`          |
| `newTensor`           | `(type: Int, ne0: Int[64]): ref[Tensor]`          |
| `newTensor`           | `(type: Int, ne0: Int[64],                        |
|                       |   ne1: Int[64]): ref[Tensor]`                     |
| `newTensor`           | `(type: Int, ne0: Int[64],                        |
|                       |   ne1: Int[64], ne2: Int[64]): ref[Tensor]`       |
| `newTensor`           | `(type: Int, ne0-3: Int[64]): ref[Tensor]`        |
| `dup`                 | `(a: ref[Tensor]): ref[Tensor]`                   |
| `dup`                 | `(a: ref[CGraph], forceGrads: Bool): ref[CGraph]` |
| `newGraph`            | `(): ref[CGraph]`                                 |
| `newGraph`            | `(size: ArchWord, grads: Bool): ref[CGraph]`      |
| `backendAllocTensors` | `(backend: ref[Backend]): ref[BackendBuffer]`     |
| `add`                 | `(a: ref[Tensor], b: ref[Tensor]): ref[Tensor]`   |
| `sub`                 | `(a: ref[Tensor], b: ref[Tensor]): ref[Tensor]`   |
| `mul`                 | `(a: ref[Tensor], b: ref[Tensor]): ref[Tensor]`   |
| `div`                 | `(a: ref[Tensor], b: ref[Tensor]): ref[Tensor]`   |
| `log`                 | `(t: ref[Tensor]): ref[Tensor]`                   |
| `sum`                 | `(a: ref[Tensor]): ref[Tensor]`                   |
| `mean`                | `(a: ref[Tensor]): ref[Tensor]`                   |
| `argmax`              | `(a: ref[Tensor]): ref[Tensor]`                   |
| `norm`                | `(a: ref[Tensor]): ref[Tensor]`                   |
| `rmsNorm`             | `(a: ref[Tensor], eps: Float): ref[Tensor]`       |
| `mulMat`              | `(a: ref[Tensor], b: ref[Tensor]): ref[Tensor]`   |
| `scale`               | `(a: ref[Tensor], alpha: Float): ref[Tensor]`     |
| `set`                 | `(a: ref[Tensor], value: Float): ref[Tensor]`     |
| `cpy`                 | `(src: ref[Tensor],`                              |
|                       | ` dst: ref[Tensor]): ref[Tensor]`                 |
| `cont`                | `(a: ref[Tensor]): ref[Tensor]`                   |
| `reshape`             | `(a: ref[Tensor], b: ref[Tensor]): ref[Tensor]`   |
| `reshape`             | `(a: ref[Tensor], ne0: Int[64]): ref[Tensor]`     |
| `reshape`             | `(a: ref[Tensor], ne0: Int[64],`                  |
|                       | ` ne1: Int[64]): ref[Tensor]`                     |
| `reshape`             | `(a: ref[Tensor], ne0-2: Int[64]): ref[Tensor]`   |
| `reshape`             | `(a: ref[Tensor], ne0-3: Int[64]): ref[Tensor]`   |
| `view`                | `(a: ref[Tensor], ne0: Int[64],`                  |
|                       | ` offset: ArchWord): ref[Tensor]`                 |
| `view`                | `(a: ref[Tensor], ne0-1: Int[64],`                |
|                       | ` nb1: ArchWord, offset: ArchWord): ref[Tensor]`  |
| `view`                | `(a: ref[Tensor], ne0-2: Int[64],`                |
|                       | ` nb1-2: ArchWord,`                               |
|                       | ` offset: ArchWord): ref[Tensor]`                 |
| `view`                | `(a: ref[Tensor], ne0-3: Int[64],`                |
|                       | ` nb1-3: ArchWord,`                               |
|                       | ` offset: ArchWord): ref[Tensor]`                 |
| `permute`             | `(a: ref[Tensor], axis1-4: Int): ref[Tensor]`     |
| `transpose`           | `(a: ref[Tensor]): ref[Tensor]`                   |
| `getRows`             | `(a: ref[Tensor], b: ref[Tensor]): ref[Tensor]`   |
| `setRows`             | `(a: ref[Tensor], b: ref[Tensor],`                |
|                       | ` c: ref[Tensor]): ref[Tensor]`                   |
| `diag`                | `(a: ref[Tensor]): ref[Tensor]`                   |
| `diagMaskInf`         | `(a: ref[Tensor], nPast: Int): ref[Tensor]`       |
| `diagMaskInfInplace`  | `(a: ref[Tensor], nPast: Int): ref[Tensor]`       |
| `diagMaskZero`        | `(a: ref[Tensor], nPast: Int): ref[Tensor]`       |
| `diagMaskZeroInplace` | `(a: ref[Tensor], nPast: Int): ref[Tensor]`       |
| `softMax`             | `(a: ref[Tensor]): ref[Tensor]`                   |
| `rope`                | `(a: ref[Tensor], b: ref[Tensor],`                |
|                       | ` nDims: Int, mode: Int): ref[Tensor]`            |
| `pad`                 | `(t: ref[Tensor], p0-3: Int): ref[Tensor]`        |
| `roll`                | `(t: ref[Tensor], shift0-3: Int): ref[Tensor]`    |
| `graphCompute`        | `(graph: ref[CGraph], nThreads: Int): Int`        |

</div>

### `مـوتر` (`Tensor`)

| الخاصية/الدالة            | الصنف                                                     |
|---------------------------|-----------------------------------------------------------|
| `الاسم`                    | `مؤشر_محارف` (قراءة/كتابة)                                |
| `البيانات`                | `مؤشر` (قراءة)                                            |
| `البيانات_ع32`            | `سند[مصفوفة[عائم]]` (قراءة)                               |
| `عدد_العناصر`             | `صحيح[64]` (قراءة)                                        |
| `عدد_الصفوف`              | `صحيح[64]` (قراءة)                                        |
| `عدد_البايتات`            | `طـبيعي_متكيف` (قراءة)                                    |
| `عدد_البايتات_بمحاذاة`    | `طـبيعي_متكيف` (قراءة)                                    |
| `حدد_كمدخل`               | `()`                                                      |
| `حدد_كمخرج`               | `()`                                                      |
| `حدد_كمعامل`              | `()`                                                      |
| `حدد_كخسارة`              | `()`                                                      |
| `حدد_من_المشغل`           | `(بيانات: مؤشر، إزاحة: طـبيعي_متكيف، حجم: طـبيعي_متكيف)`  |
| `هات_من_المشغل`           | `(بيانات: مؤشر، إزاحة: طـبيعي_متكيف، حجم: طـبيعي_متكيف)`  |

<div dir=ltr>

| Property/Method | Type/Signature                                     |
|-----------------|----------------------------------------------------|
| `name`          | `CharsPtr` (get/set)                               |
| `data`          | `ptr` (get)                                        |
| `dataF32`       | `ref[array[Float]]` (get)                          |
| `nElements`     | `Int[64]` (get)                                    |
| `nRows`         | `Int[64]` (get)                                    |
| `nBytes`        | `ArchWord` (get)                                   |
| `nBytesPad`     | `ArchWord` (get)                                   |
| `setInput`      | `()`                                               |
| `setOutput`     | `()`                                               |
| `setParam`      | `()`                                               |
| `setLoss`       | `()`                                               |
| `backendSet`    | `(data: ptr, offset: ArchWord, size: ArchWord)`    |
| `backendGet`    | `(data: ptr, offset: ArchWord, size: ArchWord)`    |

</div>

### `مـشغل` (`Backend`)

| الدالة                    | الصنف                                             |
|---------------------------|---------------------------------------------------|
| `هيئ_للمعالج`             | `(): سند[مـشغل]` (مشتركة)                         |
| `هيئ_لفلكان`              | `(رقم_جهاز: طـبيعي_متكيف): سند[مـشغل]` (مشتركة)   |
| `حرر`                     | `(سند[مـشغل])` (مشتركة)                           |
| `هات_نوع_الصوان_المبدئي`  | `(): سند[نـوع_صوان_مشغل]`                         |
| `أللمعالج`                | `ثنائي` (خاصية)                                   |
| `ألفلكان`                 | `ثنائي` (خاصية)                                   |
| `حدد_عدد_المسالك_للمعالج` | `(مسالك: صحيح)`                                   |
| `شغل_البيان`              | `(بيان: سند[بـيان]): صحيح`                        |
| `شغل_البيان_بالتوازي`     | `(بيان: سند[بـيان]): صحيح`                        |

<div dir=ltr>

| Method                | Signature                                     |
|-----------------------|-----------------------------------------------|
| `cpuInit`             | `(): ref[Backend]` (static)                   |
| `vkInit`              | `(devNum: ArchWord): ref[Backend]` (static)   |
| `free`                | `(ref[Backend])` (static)                     |
| `getDefaultBufferType`| `(): ref[BackendBufferType]`                  |
| `isCpu`               | `Bool` (property)                             |
| `isVk`                | `Bool` (property)                             |
| `cpuSetNThreads`      | `(threads: Int)`                              |
| `graphCompute`        | `(graph: ref[CGraph]): Int`                   |
| `graphComputeAsync`   | `(graph: ref[CGraph]): Int`                   |

</div>

### `بـيان` (`CGraph`)

| الدالة        | الصنف                                                     |
|---------------|-----------------------------------------------------------|
| `خطط`         | `(عدد_المسالك: صحيح، مجمع_مسالك: سند[مـجمع_مسالك]): خـطة` |
| `شغل`         | `(خطة: سند[خـطة]): صحيح`                                  |
| `أعد_الضبط`   | `()`                                                      |
| `اطبع`        | `()`                                                      |

<div dir=ltr>

| Method    | Signature                                             |
|-----------|-------------------------------------------------------|
| `plan`    | `(nThreads: Int, threadPool: ref[ThreadPool]): CPlan` |
| `compute` | `(cplan: ref[CPlan]): Int`                            |
| `reset`   | `()`                                                  |
| `print`   | `()`                                                  |

</div>

### `خـطة` (`CPlan`)

| الحقل                 | الصنف                     |
|-----------------------|---------------------------|
| `حجم_العمل`           | طـبيعي_متكيف              |
| `بيانات_العمل`        | سند[مصفوفة[طـبيعي[8]]]    |
| `عدد_المسالك`         | صحيح                      |
| `مجمع_المسالك`        | سند[مـجمع_مسالك]          |
| `دالة_الإجهاض`         | مؤشر[دالة(مؤشر)]          |
| `بيانات_دالة_الإجهاض`  | مؤشر                      |


<div dir=ltr>

| Field               | Type                  |
|---------------------|-----------------------|
| `workSize`          | ArchWord              |
| `workData`          | ref[array[Word[8]]]   |
| `nThreads`          | Int                   |
| `threadPool`        | ref[ThreadPool]       |
| `abortCallback`     | ptr[function(ptr)]    |
| `abortCallbackData` | ptr                   |

</div>

### `صـوان_مشغل` (`BackendBuffer`)

| الدالة    | الصنف                         |
|-----------|-------------------------------|
| `حرر`     | `(سند[صـوان_مشغل])` (مشتركة)  |

<div dir=ltr>

| Method | Signature                        |
|--------|----------------------------------|
| `free` | `(ref[BackendBuffer])` (static)  |

</div>

### `حـاجز_بيان` (`Gallocr`)

| الدالة        | الصنف                                                             |
|---------------|-------------------------------------------------------------------|
| `أنشئ`        | `(نوع_صوان_مشغل: سند[نـوع_صوان_مشغل]): سند[حـاجز_بيان]` (مشتركة)  |
| `حرر`         | `(سند[حـاجز_بيان])` (مشتركة)                                      |
| `احجز_بيانا`  | `(بيان: سند[بـيان]): ثنائي`                                       |

<div dir=ltr>

| Method        | Signature                                             |
|---------------|-------------------------------------------------------|
| `new`         | `(backendBufferType: ref[BackendBufferType]):`        |
|               | `ref[Gallocr]` (static)                               |
| `free`        | `(ref[Gallocr])` (static)                             |
| `allocGraph`  | `(graph: ref[CGraph]): Bool`                          |

</div>

### `مـجمع_مسالك` (`ThreadPool`)

| الدالة        | الصنف                                                 |
|---------------|-------------------------------------------------------|
| `أنشئ`        | `(معطيات: سند[مـعطيات]): سند[مـجمع_مسالك]` (مشتركة)   |
| `حرر`         | `(مجمع: سند[مـجمع_مسالك])` (مشتركة)                   |
| `عدد_المسالك` | `صحيح` (خاصية)                                        |
| `أوقف`        | `()`                                                  |
| `استأنف`      | `()`                                                  |

<div dir=ltr>

| Method     | Signature                                            |
|------------|------------------------------------------------------|
| `new`      | `(params: ref[Params]): ref[ThreadPool]` (static)    |
| `free`     | `(pool: ref[ThreadPool])` (static)                   |
| `nThreads` | `Int` (property)                                     |
| `pause`    | `()`                                                 |
| `resume`   | `()`                                                 |

</div>

### سرد `أولـوية_جدولة` (`SchedPriority`)

| الثابت        | القيمة |
|---------------|--------|
| `_منخفضة_`    | -1     |
| `_عادية_`     | 0      |
| `_متوسطة_`    | 1      |
| `_عالية_`     | 2      |
| `_وقت_حقيقي_` | 3      |

<div dir=ltr>

| Constant   | Value |
|------------|-------|
| `LOW`      | -1    |
| `NORMAL`   | 0     |
| `MEDIUM`   | 1     |
| `HIGH`     | 2     |
| `REALTIME` | 3     |

</div>

### `مـجمع_مسالك.مـعطيات` (`ThreadPool.Params`)

| الحقل             | الصنف                 |
|-------------------|-----------------------|
| `قناع_المعالجات`  | مصفوفة[ثنائي، 512]    |
| `عدد_المسالك`     | صحيح                  |
| `الأولوية`         | صحيح                  |
| `الاستقصاء`        | طـبيعي                |
| `معالج_صارم`      | ثنائي                 |
| `متوقف`           | ثنائي                 |

| الدالة            | الصنف                                                 |
|-------------------|-------------------------------------------------------|
| `هيئ`             | `(عدد_المسالك: صحيح)`                                 |
| `هات_المبدئية`    | `(): مـعطيات` (مشتركة)                                |
| `طابق`            | `(أ: سند[مـعطيات]، ب: سند[مـعطيات]): ثنائي` (مشتركة)  |

<div dir=ltr>

| Field       | Type             |
|-------------|------------------|
| `cpuMask`   | array[Bool, 512] |
| `nThreads`  | Int              |
| `prio`      | Int              |
| `poll`      | Word             |
| `strictCpu` | Bool             |
| `paused`    | Bool             |

| Method       | Signature                                          |
|--------------|----------------------------------------------------|
| `init`       | `(nThreads: Int)`                                  |
| `getDefault` | `(): Params` (static)                              |
| `match`      | `(a: ref[Params], b: ref[Params]): Bool` (static)  |

</div>


## التوثيق

للتوثيق التفصيلي للدوال الأصلية، راجع [توثيق GGML](https://github.com/ggml-org/ggml).


## الرخصة

هذه الروابط تتبع رخصة GGML (MIT). راجع ملف `license` للتفاصيل.

</div>

